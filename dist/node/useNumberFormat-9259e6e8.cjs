"use strict";var e=require("react"),i=require("@react-input/core");function t(e,i){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)i.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(t[n[r]]=e[n[r]])}return t}function n(e,i){void 0===i&&(i={});var n=i.format,r=i.groupDisplay,a=i.maximumIntegerDigits,c=void 0===a?21:a,s=t(i,["format","groupDisplay","maximumIntegerDigits"]),o=Intl.NumberFormat(e,exports.__assign(exports.__assign({},s),{style:n,useGrouping:r})).resolvedOptions();o.format=o.style,o.groupDisplay=o.useGrouping,o.maximumIntegerDigits=c,o.maximumIntegerDigits<o.minimumIntegerDigits&&(o.maximumIntegerDigits=o.minimumIntegerDigits);var l=o;return delete l.style,delete l.currencySign,delete l.useGrouping,delete l.minimumSignificantDigits,delete l.maximumSignificantDigits,delete l.compactDisplay,delete l.notation,delete l.numberingSystem,delete l.localeMatcher,delete l.roundingIncrement,delete l.roundingMode,delete l.roundingPriority,delete l.trailingZeroDisplay,{current:i,resolved:o}}function r(e){var i=Intl.NumberFormat(e,{useGrouping:!1,signDisplay:"always",minimumIntegerDigits:10,minimumFractionDigits:1,maximumFractionDigits:1}).format(-1234567890.1),t="‎"===i[0]||"؜"===i[0],n=t?i[1]:i[0],r=i[i.length-2],a=i.slice(t?2:1,-2);return{signBackwards:t,minusSign:n,decimal:r,digits:a=a[9]+a.slice(0,-1)}}function a(e){var i=e.resolvedOptions.minimumFractionDigits,t=void 0===i?0:i;return t<0?0:t}exports.__assign=function(){return exports.__assign=Object.assign||function(e){for(var i,t=1,n=arguments.length;t<n;t++)for(var r in i=arguments[t])Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);return e},exports.__assign.apply(this,arguments)},exports.__rest=t,exports.useNumberFormat=function(c){var s=null!=c?c:{},o=s.locales,l=s.format,u=s.currency,g=s.currencyDisplay,m=s.unit,d=s.unitDisplay,p=s.signDisplay,v=s.groupDisplay,f=s.minimumIntegerDigits,x=s.maximumIntegerDigits,D=s.minimumFractionDigits,y=s.maximumFractionDigits,h=s.onNumberFormat,E={format:l,currency:u,currencyDisplay:g,unit:m,unitDisplay:d,signDisplay:p,groupDisplay:v,minimumIntegerDigits:f,maximumIntegerDigits:x,minimumFractionDigits:D,maximumFractionDigits:y},I=e.useRef(null),O=JSON.stringify(o),S=JSON.stringify(E),R=e.useCallback((function(e){var i=e.initialValue,t={locales:o,options:E};return I.current={value:i,props:t,fallbackProps:t},{value:i}}),[]),b=e.useCallback((function(e){var c=e.inputType,s=e.addedValue,l=e.previousValue,u=e.changeStart,g=e.changeEnd;if(null===I.current)throw new i.SyntheticChangeError("The state has not been initialized.");I.current.value!==l?I.current.props=I.current.fallbackProps:I.current.fallbackProps=I.current.props;var m=r(I.current.props.locales),d=r(o),p=n(o,E),v=p.current,f=p.resolved,x=function(e){var i="\\-\\".concat(d.minusSign),t=".,".concat(d.decimal),n="\\d".concat(d.digits),r="[^".concat(i).concat(t).concat(n,"]|[").concat(t,"](?=.*[").concat(t,"])"),a=e.replace(RegExp(r,"g"),"");if(d.signBackwards)return a.replace(RegExp("[".concat(i,"](?=.*[").concat(i).concat(t).concat(n,"])"),"g"),"");var c=a.search(RegExp("[".concat(i,"]"))),s=a.search(RegExp("[".concat(t,"]"))),o=a.search(RegExp("[".concat(n,"]")));return a.replace(RegExp("[".concat(i,"]"),"g"),(function(e,i){return-1!==c&&i>c||-1!==s&&i>s||-1!==o&&i>o?"":e}))};if(s=x(s),"insert"===c&&!s)throw new i.SyntheticChangeError("The added value does not contain allowed characters.");var D=RegExp("[^\\".concat(m.minusSign).concat(m.decimal).concat(m.digits,"]"),"g"),y=l.slice(0,u).replace(D,"")+s+l.slice(g).replace(D,"");y=x(y).replace(RegExp("[,".concat(d.decimal,"]"),"g"),".").replace(RegExp(d.minusSign,"g"),"-").replace(RegExp("[".concat(d.digits,"]"),"g"),(function(e){var i=d.digits.indexOf(e);return-1!==i?i.toString():e}));var h=RegExp("^[\\-\\".concat(d.minusSign,"]$")).test(s)&&u===g,O=l.includes(m.minusSign),S=y.includes("-");if(h&&O&&S&&(y=y.replace("-","")),!h||O||S||(y="-".concat(y)),"-"===y[y.length-1]&&(y="-".concat(y.slice(0,-1))),/\..*0$/.test(y)){for(var R="",b=-1,w=0,_=!1;w<l.length;w++){var F=m.digits.includes(l[w]),V=l[w]===m.decimal;_?F&&(R+=l[w],-1===b&&(b=w)):V&&(_=!0)}if(-1!==b){var k=a({resolvedOptions:n(I.current.props.locales,I.current.props.options).resolved});u>=b&&g<b+(k||1)&&R.length<=(k||1)&&(y=y.replace(/0+$/g,""))}}var N=function(e,i){var n=i.inputType,r=i.locales,c=i.localizedValues,s=i.currentOptions,o=i.resolvedOptions;if(("deleteBackward"===n||"deleteForward"===n)&&(""===e||"-"===e||/^-?\.?0*$/.test(e)))return{value:"",number:0};var l="-"===e[0],u=(l?e.slice(1):e).split("."),g=u[0],m=u[1],d=void 0===m?void 0:m,p=o.minimumFractionDigits,v=o.maximumFractionDigits;g=g.replace(/^0+/g,"").slice(0,o.maximumIntegerDigits),d=null==d?void 0:d.slice(0,v);var f=Number((l?"-":"")+(g||"0")+(d?".".concat(d):""));p=a({resolvedOptions:o}),"insert"===n&&""===d&&0===p&&v>0&&(p=1),void 0!==d&&d.length>p&&(p=d.length);var x=null!=s?s:{},D=x.format,y=x.groupDisplay;x.maximumIntegerDigits;var h=t(x,["format","groupDisplay","maximumIntegerDigits"]),E=Intl.NumberFormat(r,exports.__assign(exports.__assign({},h),{style:D,useGrouping:y,minimumFractionDigits:p})).format(f),I=(E=E.replace(/\s/g," ")).includes("+")?"+":E.includes(c.minusSign)?c.minusSign:void 0;if(void 0!==I&&c.signBackwards){var O=(E=E.replace(RegExp("[‎؜\\".concat(I,"]"),"g"),"")).search(RegExp("[".concat(c.digits,"](?!.*[").concat(c.digits,"])")));-1!==O&&"‏"!==(E=E.slice(0,O+1)+I+E.slice(O+1))[0]&&(E="‏".concat(E))}return{value:E,number:f}}(y,{inputType:c,locales:o,localizedValues:d,currentOptions:v,resolvedOptions:f}),P=function(e){var i,t,n,r=e.localizedValues,a=e.previousLocalizedValues,c=e.resolvedOptions,s=e.inputType,o=e.addedValue,l=e.previousValue,u=e.nextValue,g=e.changeStart,m=e.changeEnd;if(RegExp("^[.,".concat(r.decimal,"]$")).test(o)&&l.includes(r.decimal)){var d=u.indexOf(r.decimal);if(-1!==d)return{start:p=d+1,end:p}}if(RegExp("^[\\-\\".concat(r.minusSign,"]$")).test(o)&&l.includes(r.minusSign)){var p,v=u.indexOf(r.minusSign);if(-1!==v)return{start:p=v+(r.signBackwards?0:1),end:p}}if("deleteBackward"===s||"deleteForward"===s){var f=l.split(a.decimal)[0];if(m<=f.length&&!RegExp("[".concat(a.digits.slice(1),"]")).test(f)){var x=f.indexOf(a.digits[0]),D=f.lastIndexOf(a.digits[0]);if(-1!==x&&-1!==D&&(g!==x||m!==D+1)&&m>x&&m<=D+1)return{start:x,end:D+1}}}for(var y=u.length,h=0,E=0,I=!1;E<g;E++){var O=a.digits.includes(l[E]);if(!I){var S=l[E]===a.decimal,R=O&&l[E]!==a.digits[0];(S||R)&&(I=!0)}I&&O&&(h+=1)}if("insert"===s){var b=l.slice(0,g),w=b.replace(RegExp("[^".concat(a.decimal).concat(a.digits,"]"),"g"),"").replace(RegExp("^".concat(a.digits[0],"+"),"g"),"").split(a.decimal),_=w[0],F=w[1],V=void 0===F?"":F,k=RegExp("[^\\d".concat(r.digits,"]+"),"g"),N=l.indexOf(a.decimal),P=o.replace(RegExp("[\\-\\".concat(r.minusSign,"]"),"g"),"").replace(RegExp("[,".concat(r.decimal,"]"),"g"),".");-1!==N&&m<=N&&(P=P.replace(k,""));var T=P.split("."),$=T[0],z=T[1],B=void 0===z?"":z;if(-1!==N&&g>N)if(P.includes(".")){var j=_+V;j.length>c.maximumIntegerDigits&&(h=c.maximumIntegerDigits,_=j.slice(0,c.maximumIntegerDigits))}else B=$,$="";var G="[".concat(a.decimal).concat(a.digits.slice(1),"]");if(!RegExp(G).test(b)){var C="^[0".concat(a.digits[0],"]+");$=$.replace(RegExp(C,"g"),"")}h+=($.slice(0,c.maximumIntegerDigits-_.length)+B).replace(k,"").length}E=0,I=!1;for(var q=0;E<u.length;E++){if(I||r.decimal!==u[E]&&!r.digits.slice(1).includes(u[E])||(I=!0),I&&q>=h){y=E;break}I&&r.digits.includes(u[E])&&(q+=1)}if("deleteForward"===s){G="^.{".concat(y,"}[^").concat(r.digits,"]*[\\").concat(r.minusSign).concat(r.digits,"]");var J=null===(i=u.match(RegExp(G)))||void 0===i?void 0:i[0].length;void 0!==J&&(y=J-1)}else{G="[".concat("deleteBackward"===s?"\\".concat(r.minusSign):"").concat(r.digits,"][^").concat(r.digits,"]*.{").concat(u.length-y,"}$");var L=null===(t=u.match(RegExp(G)))||void 0===t?void 0:t.index;void 0!==L&&(y=L+1),u[y]===r.decimal&&RegExp("[.,".concat(r.decimal,"]")).test(null!==(n=o[o.length-1])&&void 0!==n?n:"")&&(y+=1)}G="[\\".concat(r.minusSign).concat(r.decimal).concat(r.digits.slice(1),"]"),C="[\\".concat(r.minusSign).concat(r.digits,"][^").concat(r.digits,"]*$");var M=u.search(RegExp(G)),H=u.search(RegExp(C));return-1!==M&&y<M?y=M:-1!==H&&y>H+1&&(y=H+1),{start:y,end:y}}({localizedValues:d,previousLocalizedValues:m,resolvedOptions:f,inputType:c,addedValue:s,previousValue:l,nextValue:N.value,changeStart:u,changeEnd:g});return I.current.value=N.value,I.current.props={locales:o,options:E},{value:N.value,selectionStart:P.start,selectionEnd:P.end,__detail:N}}),[O,S]),w=i.useInput({init:R,tracking:b,customInputEventType:"input-number-format",customInputEventHandler:h});return function(i){var t=i.locales,r=i.options;e.useEffect((function(){if("production"!==process.env.NODE_ENV){var e=n(t,r),i=e.current,a=e.resolved,c="number"!=typeof i.maximumIntegerDigits&&void 0!==i.maximumIntegerDigits,s="number"==typeof i.maximumIntegerDigits&&i.maximumIntegerDigits<a.minimumIntegerDigits;if(c||s)throw new RangeError("maximumIntegerDigits value is out of range.")}}),[])}({locales:o,options:E}),w};
